Training MAP parameters
Beginning epoch 1
Beginning epoch 2
Beginning epoch 3
Beginning epoch 4
Beginning epoch 5
Beginning epoch 6
Beginning epoch 7
Beginning epoch 8
Beginning epoch 9
Beginning epoch 10
Elapsed time: 9082.139652252197 seconds for MAP training over 10 epochs
Saving MAP parameters after finetuning to /hpcgpfs01/work/sjantre/lora-ensemble-v1/results/bayesian_lora/models/biomedgpt-set-4-seed-1/MAP_params.pth
Evaluating the MAP log likelihood
Computing the low-rank Kronecker factors
Optimising priors using marginal likelihood
prior variance is: 0.9998379945755005
Doing linearized prediction
Accuracy: 0.7858
MCC: 0.6117
AUC: 0.9279
Confusion Matrix:
tensor([[ 737,  457],
        [  47, 1112]])
Specificity: 0.6173
Precision (Macro): 0.8244
F1 Score (Macro): 0.7802
Expected Calibration Error (ECE): 0.1789
NLL loss: 0.6432
Bayesian LoRA model successfully finished.
